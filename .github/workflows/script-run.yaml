name: "Check Package-Lock"

on:
  push: # Runs on merge (push) to $branch
    branches:
      - notify-slack

concurrency:
  # Only allow one workflow in the 'main' group to run at a time. Others will queue up
  # https://docs.github.com/en/actions/learn-github-actions/workflow-syntax-for-github-actions#concurrency
  group: main

jobs:
  log-context:
    name: Log github context
    runs-on: ubuntu-latest
    steps:
      - name: Log Context
        uses: actions/github-script@v5
        with:
          script: console.log(JSON.stringify(context, null, 2))
  package-lock-script:
    name: Package lock script
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Script file checker
        uses: actions/github-script@v6
        with:
          script: |
            const script = require('.github/scripts/index.js');
            script({github, context});
        env:
          webhook-url: "fakeWebhookUrl.net"
